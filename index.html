<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Akuntansi Pintar</title>
    <meta name="description" content="Aplikasi Akuntansi Pintar untuk UMKM">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800&family=Montserrat:wght@400;700&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/feather-icons"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.3/dist/chart.umd.min.js"></script>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <header>
        <h1 id="app-company-name">Akuntansi Pintar</h1>
    </header>

    <main class="container">
        <nav class="tab-navigation">
            <button class="tab-button active" data-tab="kasir">
                <i data-feather="shopping-cart"></i> Kasir
            </button>
            <button class="tab-button" data-tab="produk">
                <i data-feather="box"></i> Produk
            </button>
            <button class="tab-button" data-tab="pengeluaran">
                <i data-feather="dollar-sign"></i> Pengeluaran
            </button>
            <button class="tab-button" data-tab="laporan">
                <i data-feather="file-text"></i> Laporan Penjualan
            </button>
            <button class="tab-button" data-tab="rekapan">
                <i data-feather="pie-chart"></i> Rekapan Keuangan
            </button>
            <button class="tab-button" data-tab="pengaturan">
                <i data-feather="settings"></i> Pengaturan
            </button>
        </nav>

        <div id="kasir" class="tab-content active">
            <div class="kasir-layout">
                <div class="left-panel">
                    <h2><i data-feather="tag"></i> Input Produk</h2>
                    <div class="form-group">
                        <label for="product-select">Pilih Produk:</label>
                        <select id="product-select">
                            <option value="">-- Pilih Produk --</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="category-filter">Filter Kategori:</label>
                        <select id="category-filter">
                            <option value="">-- Semua Kategori --</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="product-name">Nama Produk:</label>
                        <input type="text" id="product-name" readonly placeholder="Akan terisi otomatis">
                    </div>
                    <div class="form-group">
                        <label for="product-price">Harga (Rp):</label>
                        <input type="number" id="product-price" readonly placeholder="Akan terisi otomatis">
                    </div>
                    <div class="form-group">
                        <label for="product-stock-display">Sisa Stok:</label>
                        <input type="text" id="product-stock-display" readonly placeholder="Akan terisi otomatis">
                    </div>
                    <div class="form-group">
                        <label for="product-quantity">Jumlah:</label>
                        <input type="number" id="product-quantity" value="1" min="1" placeholder="Jumlah produk">
                    </div>
                    <div class="button-group">
                        <button class="primary" id="add-to-cart-btn"><i data-feather="plus-circle"></i> Tambah ke Keranjang</button>
                        <button class="secondary" id="clear-input-btn"><i data-feather="refresh-cw"></i> Bersihkan Input</button>
                    </div>
                </div>

                <div class="right-panel">
                    <h2><i data-feather="shopping-bag"></i> Keranjang Belanja</h2>
                    <div class="cart-items" id="cart-items">
                        <p class="empty-cart-message">Keranjang kosong. Pilih produk dari daftar.</p>
                    </div>
                    <div class="cart-summary">
                        <div class="summary-row">
                            <span>Subtotal:</span>
                            <span id="subtotal">Rp 0</span>
                        </div>
                        <div class="form-group">
                            <label for="discount-type">Jenis Diskon:</label>
                            <select id="discount-type">
                                <option value="none">Tidak Ada Diskon</option>
                                <option value="percentage">Persentase (%)</option>
                                <option value="nominal">Nominal (Rp)</option>
                            </select>
                        </div>
                        <div class="form-group" id="discount-value-group" style="display:none;">
                            <label for="discount-value">Nilai Diskon:</label>
                            <input type="number" id="discount-value" value="0" min="0" placeholder="Masukkan nilai diskon">
                        </div>
                        <div class="summary-row">
                            <span>Diskon:</span>
                            <span id="discount">Rp 0</span>
                        </div>
                        <div class="summary-row total">
                            <span>Total Pembayaran:</span>
                            <span id="total-payment">Rp 0</span>
                        </div>
                        <div class="form-group">
                            <label for="amount-paid">Jumlah Dibayar (Rp):</label>
                            <input type="number" id="amount-paid" value="0" min="0" placeholder="Masukkan jumlah uang dibayar">
                        </div>
                        <div class="summary-row total" id="change-row">
                            <span>Kembalian:</span>
                            <span id="change-amount">Rp 0</span>
                        </div>
                        <div class="button-group">
                            <button class="success" id="process-payment-btn"><i data-feather="dollar-sign"></i> Proses Pembayaran</button>
                            <button class="danger" id="clear-cart-btn"><i data-feather="trash-2"></i> Bersihkan Keranjang</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div id="produk" class="tab-content">
            <h2><i data-feather="database"></i> Manajemen Produk</h2>
            <div class="product-form-container">
                <div class="form-group">
                    <label for="new-product-name">Nama Produk Baru:</label>
                    <input type="text" id="new-product-name" placeholder="Contoh: Kopi Americano">
                </div>
                <div class="form-group">
                    <label for="new-product-category">Kategori:</label>
                    <input type="text" id="new-product-category" placeholder="Contoh: Minuman, Makanan">
                </div>
                <div class="form-group">
                    <label for="new-product-cost-price">Harga Beli (Rp):</label>
                    <input type="number" id="new-product-cost-price" min="0" value="0" placeholder="Harga beli produk">
                </div>
                <div class="form-group">
                    <label for="new-product-price">Harga Jual (Rp):</label>
                    <input type="number" id="new-product-price" min="0" value="0" placeholder="Harga jual produk">
                </div>
                <div class="form-group">
                    <label for="new-product-markup-percentage">Markup (%):</label>
                    <input type="number" id="new-product-markup-percentage" min="0" max="1000" step="0.01" readonly title="Markup dihitung otomatis (Harga Jual - Harga Beli) / Harga Beli * 100">
                </div>
                <div class="form-group">
                    <label for="new-product-stock">Stok Awal:</label>
                    <input type="number" id="new-product-stock" min="0" value="0" placeholder="Jumlah stok awal">
                </div>
                <div class="form-group">
                    <label for="new-product-min-stock">Min. Stok untuk Peringatan:</label>
                    <input type="number" id="new-product-min-stock" min="0" value="0" placeholder="Stok minimum untuk peringatan">
                </div>
                <div class="button-group">
                    <button class="primary" id="add-new-product-btn"><i data-feather="plus"></i> Tambah Produk Baru</button>
                </div>
            </div>

            <table id="product-table">
                <thead>
                    <tr>
                        <th>ID Produk</th>
                        <th>Nama</th>
                        <th>Kategori</th>
                        <th>Harga Beli</th>
                        <th>Harga Jual</th>
                        <th>Markup (%)</th>
                        <th>Stok</th>
                        <th>Min. Stok</th>
                        <th>Aksi</th>
                    </tr>
                </thead>
                <tbody id="product-list-body">
                    <tr class="empty-table-message"><td colspan="9">Belum ada produk yang tercatat.</td></tr>
                </tbody>
            </table>
        </div>

        <div id="pengeluaran" class="tab-content">
            <h2><i data-feather="minus-circle"></i> Manajemen Pengeluaran</h2>
            <div class="form-group">
                <label for="expense-date">Tanggal Pengeluaran:</label>
                <input type="date" id="expense-date" required>
            </div>
            <div class="form-group">
                <label for="expense-category">Kategori Pengeluaran:</label>
                <input type="text" id="expense-category" placeholder="Contoh: Sewa, Gaji, Listrik" required>
            </div>
            <div class="form-group">
                <label for="expense-description">Deskripsi:</label>
                <textarea id="expense-description" placeholder="Deskripsi detail pengeluaran" rows="3"></textarea>
            </div>
            <div class="form-group">
                <label for="expense-amount">Jumlah (Rp):</label>
                <input type="number" id="expense-amount" min="0" value="0" required placeholder="Jumlah pengeluaran">
            </div>
            <div class="button-group">
                <button class="danger" id="add-expense-btn"><i data-feather="plus"></i> Tambah Pengeluaran</button>
            </div>

            <table id="expense-table">
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>Tanggal</th>
                        <th>Kategori</th>
                        <th>Deskripsi</th>
                        <th>Jumlah (Rp)</th>
                        <th>Aksi</th>
                    </tr>
                </thead>
                <tbody id="expense-list-body">
                    <tr class="empty-table-message"><td colspan="6">Belum ada pengeluaran yang tercatat.</td></tr>
                </tbody>
            </table>
        </div>

        <div id="laporan" class="tab-content">
            <h2><i data-feather="clipboard"></i> Laporan Penjualan</h2>
            <div class="form-group">
                <label for="report-date-filter">Filter Tanggal:</label>
                <input type="month" id="report-date-filter" title="Filter laporan berdasarkan bulan dan tahun">
            </div>
            <table id="transaction-table">
                <thead>
                    <tr>
                        <th>ID Transaksi</th>
                        <th>Tanggal</th>
                        <th>Total</th>
                        <th>Diskon</th>
                        <th>Aksi</th>
                    </tr>
                </thead>
                <tbody id="transaction-list-body">
                    <tr class="empty-table-message"><td colspan="5">Belum ada transaksi yang tercatat.</td></tr>
                </tbody>
            </table>
        </div>

        <div id="rekapan" class="tab-content">
            <h2><i data-feather="pie-chart"></i> Rekapan Keuangan Keseluruhan</h2>
            <div class="recap-summary" id="recap-summary-content">
                <div class="recap-card">
                    <h3>Total Pendapatan</h3>
                    <div class="amount" id="recap-revenue">Rp 0</div>
                </div>
                <div class="recap-card expense">
                    <h3>Total HPP</h3>
                    <div class="amount" id="recap-cost-of-goods">Rp 0</div>
                </div>
                 <div class="recap-card expense">
                    <h3>Total Pengeluaran</h3>
                    <div class="amount" id="recap-total-expense">Rp 0</div>
                </div>
                <div class="recap-card profit">
                    <h3>Laba Bersih</h3>
                    <div class="amount" id="recap-profit">Rp 0</div>
                </div>
            </div>

            <div class="chart-container">
                <h3 style="color: var(--primary-dark-gold); margin-bottom: 20px;">Grafik Pendapatan</h3>
                <div class="form-group" style="width: 100%; max-width: 300px; text-align: center;">
                    <label for="chart-filter">Tampilan Grafik:</label>
                    <select id="chart-filter">
                        <option value="daily">Harian (30 Hari Terakhir)</option>
                        <option value="weekly">Mingguan (12 Minggu Terakhir)</option>
                        <option value="monthly">Bulanan (12 Bulan Terakhir)</option>
                        <option value="yearly">Tahunan</option>
                    </select>
                </div>
                <canvas id="incomeTrendChart" aria-label="Grafik Tren Pendapatan" role="img"></canvas>
                <p id="chart-empty-message" class="empty-chart-message" style="display:none;">Tidak ada data transaksi untuk menampilkan grafik.</p>
            </div>
        </div>

        <div id="pengaturan" class="tab-content">
            <h2><i data-feather="settings"></i> Pengaturan Aplikasi</h2>
            <div class="settings-section">
                <h3>Nama Perusahaan</h3>
                <div class="form-group">
                    <label for="company-name-input">Nama Perusahaan/Toko:</label>
                    <input type="text" id="company-name-input" placeholder="Masukkan nama perusahaan Anda">
                </div>
                <div class="button-group">
                    <button class="primary" id="save-company-name-btn"><i data-feather="save"></i> Simpan Nama Perusahaan</button>
                </div>
            </div>
            <div class="settings-section">
                <h3>Manajemen Pengguna <span style="font-weight: normal; font-size: 0.8em; color: var(--info-color);">(Admin Only)</span></h3>
                <p class="settings-info">Tambahkan pengguna baru atau lihat daftar pengguna. Untuk keamanan, aplikasi ini hanya menyimpan data di browser Anda.</p>
                <div class="form-group">
                    <label for="new-user-username">Username:</label>
                    <input type="text" id="new-user-username" placeholder="Masukkan username baru">
                </div>
                <div class="form-group">
                    <label for="new-user-password">Password:</label>
                    <input type="*
